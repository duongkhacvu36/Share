<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>TrÃ¬nh duyá»‡t tá»‡p â€” Chia sáº» qua GitHub</title>

<style>
/* ğŸ¨ ToÃ n bá»™ mÃ u vÃ  hiá»‡u á»©ng trong suá»‘t */
:root {
  color-scheme: light dark;
  font-family: "Inter", system-ui, sans-serif;
  --glass-bg: rgba(255,255,255,0.15);
  --glass-blur: blur(18px);
  --text: #f5f5f5;
  --accent: #4fa3ff;
  --border: rgba(255,255,255,0.25);
  --shadow: 0 4px 20px rgba(0,0,0,0.3);
  background: linear-gradient(145deg, #1e1e2f, #2a2a40);
  min-height: 100vh;
  color: var(--text);
}

/* ğŸ§Š Hiá»‡u á»©ng khá»‘i kÃ­nh */
.glass {
  background: var(--glass-bg);
  backdrop-filter: var(--glass-blur);
  border: 1px solid var(--border);
  border-radius: 12px;
  box-shadow: var(--shadow);
}

/* ğŸŒŸ TiÃªu Ä‘á» */
header {
  text-align: center;
  padding: 20px;
}
h1 { margin: 0; font-size: 1.4rem; color: var(--accent); }

/* ğŸ“¦ Khá»‘i ná»™i dung chÃ­nh */
.container {
  max-width: 950px;
  margin: 0 auto;
  padding: 16px;
}

/* ğŸ”˜ CÃ¡c Ã´ nháº­p vÃ  nÃºt báº¥m */
input, select, button {
  padding: 8px 10px;
  border-radius: 8px;
  border: 1px solid var(--border);
  background: rgba(255,255,255,0.05);
  color: var(--text);
  font-size: 0.95rem;
}
button {
  cursor: pointer;
  background: var(--accent);
  border: none;
  color: white;
  transition: 0.2s;
}
button:hover { opacity: 0.9; }

/* ğŸ“‹ Báº£ng danh sÃ¡ch file */
table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 12px;
  font-size: 0.9rem;
}
th, td {
  padding: 10px;
  border-bottom: 1px solid var(--border);
  text-align: left;
}
th { background: rgba(255,255,255,0.1); }

a {
  color: var(--accent);
  text-decoration: none;
}
a:hover { text-decoration: underline; }

.empty {
  text-align: center;
  color: #ccc;
  padding: 20px;
}

/* ğŸ” Thanh tÃ¬m kiáº¿m + filter */
.tools {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin: 12px 0;
}

/* ğŸ“± Tá»‘i Æ°u hiá»ƒn thá»‹ cho Ä‘iá»‡n thoáº¡i */
@media (max-width: 640px) {
  table { display: block; overflow-x: auto; }
  th, td { white-space: nowrap; }
}
</style>
</head>

<body>
<header>
  <h1>ğŸ“‚ TrÃ¬nh duyá»‡t tá»‡p GitHub (Giao diá»‡n KÃ­nh)</h1>
  <p>Duyá»‡t vÃ  táº£i tá»‡p trá»±c tiáº¿p tá»« GitHub Repository cá»§a báº¡n</p>
</header>

<main class="container glass">
  <!-- ğŸ§­ Thanh cáº¥u hÃ¬nh repo -->
  <div class="tools">
    <input id="owner" value="duongkhacvu36" placeholder="Chá»§ sá»Ÿ há»¯u (Owner)">
    <input id="repo" value="Share" placeholder="TÃªn repo">
    <input id="branch" value="main" placeholder="NhÃ¡nh (branch)">
    <input id="path" placeholder="ÄÆ°á»ng dáº«n (vÃ­ dá»¥: docs)">
    <button id="loadBtn">Táº£i danh sÃ¡ch</button>
  </div>

  <!-- ğŸ” Bá»™ lá»c tÃ¬m kiáº¿m -->
  <div class="tools">
    <input id="search" placeholder="ğŸ” TÃ¬m theo tÃªn tá»‡p...">
    <select id="typeFilter">
      <option value="">Táº¥t cáº£</option>
      <option value="dir">ThÆ° má»¥c</option>
      <option value="file">Tá»‡p</option>
    </select>
    <button id="refresh">LÃ m má»›i</button>
  </div>

  <!-- ğŸ“œ Báº£ng hiá»ƒn thá»‹ file -->
  <table>
    <thead>
      <tr>
        <th>TÃªn</th><th>KÃ­ch thÆ°á»›c</th><th>Loáº¡i</th><th>HÃ nh Ä‘á»™ng</th>
      </tr>
    </thead>
    <tbody id="filesBody">
      <tr><td colspan="4" class="empty">Nháº¥n â€œTáº£i danh sÃ¡châ€ Ä‘á»ƒ xem tá»‡p.</td></tr>
    </tbody>
  </table>

  <!-- ğŸ–¼ï¸ Há»™p xem trÆ°á»›c file -->
  <div id="previewBox" class="glass" style="margin-top:20px; display:none; padding:16px;">
    <h3>ğŸ‘ï¸â€ğŸ—¨ï¸ Xem trÆ°á»›c tá»‡p</h3>
    <div id="previewContent" style="overflow:auto; max-height:400px;"></div>
    <button onclick="closePreview()">ÄÃ³ng xem trÆ°á»›c</button>
  </div>
</main>

<script>
/* =============================
   âš™ï¸ CÃC HÃ€M CHÃNH
============================= */

// Láº¥y pháº§n tá»­ nhanh
const el = id => document.getElementById(id);
const filesBody = el('filesBody');

// Gá»i GitHub API Ä‘á»ƒ láº¥y danh sÃ¡ch tá»‡p trong repo
async function apiList(owner, repo, path, branch) {
  const url = `https://api.github.com/repos/${owner}/${repo}/contents/${path?path:''}?ref=${branch}`;
  const r = await fetch(url);
  if (!r.ok) throw new Error(`GitHub API lá»—i ${r.status}`);
  return r.json();
}

// Táº¡o URL raw cá»§a file Ä‘á»ƒ táº£i hoáº·c xem
function rawUrl(owner, repo, branch, path) {
  return `https://raw.githubusercontent.com/${owner}/${repo}/${branch}/${path}`;
}

// Äá»‹nh dáº¡ng dung lÆ°á»£ng tá»‡p
function formatBytes(b){
  if(!b) return '-';
  const k=1024, sizes=['B','KB','MB','GB'];
  const i=Math.floor(Math.log(b)/Math.log(k));
  return (b/Math.pow(k,i)).toFixed(2)+' '+sizes[i];
}

// Hiá»ƒn thá»‹ danh sÃ¡ch file lÃªn báº£ng
function renderList(owner, repo, branch, list) {
  const q = el('search').value.toLowerCase();
  const type = el('typeFilter').value;

  const rows = list.filter(f=>{
    if(type && f.type!==type) return false;
    if(q && !f.name.toLowerCase().includes(q)) return false;
    return true;
  }).map(f=>{
    if(f.type==='dir'){
      return `<tr>
        <td>ğŸ“ <a href="#" data-dir="${f.path}" class="dir">${f.name}</a></td>
        <td>-</td><td>ThÆ° má»¥c</td><td></td>
      </tr>`;
    } else {
      const url = rawUrl(owner,repo,branch,f.path);
      return `<tr>
        <td>ğŸ“„ ${f.name}</td>
        <td>${formatBytes(f.size)}</td>
        <td>${f.type}</td>
        <td>
          <a href="${url}" target="_blank" download>Táº£i</a> |
          <a href="#" onclick="previewFile('${url}','${f.name}')">Xem trÆ°á»›c</a>
        </td>
      </tr>`;
    }
  });

  filesBody.innerHTML = rows.length ? rows.join('') :
    '<tr><td colspan="4" class="empty">KhÃ´ng cÃ³ tá»‡p nÃ o.</td></tr>';

  // Cho phÃ©p báº¥m vÃ o thÆ° má»¥c Ä‘á»ƒ má»Ÿ tiáº¿p
  filesBody.querySelectorAll('.dir').forEach(a=>a.onclick=e=>{
    e.preventDefault();
    el('path').value=a.dataset.dir;
    loadFiles();
  });
}

/* =============================
   ğŸ“¥ HÃ€M Táº¢I DANH SÃCH FILE
============================= */
async function loadFiles() {
  const owner = el('owner').value.trim();
  const repo = el('repo').value.trim();
  const branch = el('branch').value.trim() || 'main';
  const path = el('path').value.trim();
  if(!owner||!repo) return alert('Vui lÃ²ng nháº­p Ä‘á»§ Owner vÃ  Repo');

  filesBody.innerHTML='<tr><td colspan="4" class="empty">Äang táº£i...</td></tr>';
  try {
    const data = await apiList(owner,repo,path,branch);
    const list = Array.isArray(data)?data:[data];
    renderList(owner,repo,branch,list);
  } catch(e) {
    filesBody.innerHTML=`<tr><td colspan="4" class="empty">Lá»—i: ${e.message}</td></tr>`;
  }
}

/* =============================
   ğŸ–¼ï¸ HÃ€M XEM TRÆ¯á»šC FILE
============================= */
async function previewFile(url, name){
  const box = el('previewBox');
  const content = el('previewContent');
  box.style.display='block';
  content.innerHTML = '<i>Äang táº£i xem trÆ°á»›c...</i>';
  const lower = name.toLowerCase();

  try {
    // Xá»­ lÃ½ theo loáº¡i tá»‡p
    if(lower.endsWith('.jpg')||lower.endsWith('.png')||lower.endsWith('.gif')){
      content.innerHTML = `<img src="${url}" style="max-width:100%; border-radius:8px;">`;
    } else if(lower.endsWith('.pdf')){
      content.innerHTML = `<iframe src="${url}" width="100%" height="400px" style="border:none;"></iframe>`;
    } else if(lower.endsWith('.txt')||lower.endsWith('.md')){
      const text = await (await fetch(url)).text();
      content.innerHTML = `<pre style="white-space:pre-wrap;">${text.replace(/[&<>]/g,m=>({'&':'&amp;','<':'&lt;','>':'&gt;'}[m]))}</pre>`;
    } else {
      content.innerHTML = `<p>âŒ Loáº¡i tá»‡p nÃ y khÃ´ng há»— trá»£ xem trÆ°á»›c.</p>`;
    }
  } catch(e) {
    content.innerHTML = `<p>Lá»—i khi táº£i tá»‡p: ${e.message}</p>`;
  }
}
function closePreview(){ el('previewBox').style.display='none'; }

/* =============================
   ğŸ”„ Sá»° KIá»†N GIAO DIá»†N
============================= */
el('loadBtn').onclick = loadFiles;
el('refresh').onclick = loadFiles;
el('search').oninput = loadFiles;
el('typeFilter').onchange = loadFiles;
</script>
</body>
</html>
